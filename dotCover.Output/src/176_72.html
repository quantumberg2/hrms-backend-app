<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\USER\source\HRMS\hrms-backend-app\HRMS Application\Controllers\EmployeeImportController .cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using Microsoft.AspNetCore.Authorization;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;
using System.IdentityModel.Tokens.Jwt;
using System.Linq;
using System.Threading.Tasks;
using HRMS_Application.BusinessLogic.Interface;

namespace HRMS_Application.Controllers
{
    [Route(&quot;api/[controller]&quot;)]
    [ApiController]
    public class EmployeeImportController : ControllerBase
    {
        private readonly IEmployeeImportService _employeeImportService;

        public EmployeeImportController(IEmployeeImportService employeeImportService)
        {
            _employeeImportService = employeeImportService;
        }

        [HttpPost(&quot;import&quot;)]
        public async Task&lt;IActionResult&gt; ImportEmployees(IFormFile file)
        {
            if (file == null || file.Length == 0)
            {
                return BadRequest(&quot;No file uploaded.&quot;);
            }

            // Extract companyId from the token
            var token = HttpContext.Request.Headers[&quot;Authorization&quot;].ToString().Replace(&quot;Bearer&quot;, &quot;&quot;);
            var handler = new JwtSecurityTokenHandler();
            var jwtToken = handler.ReadJwtToken(token);
            var companyId = int.Parse(jwtToken.Claims.First(claim =&gt; claim.Type == &quot;CompanyId&quot;).Value);

            using (var stream = file.OpenReadStream())
            {
                var result = await _employeeImportService.ImportEmployeesFromExcelAsync(stream, companyId);
                return Ok(new
                {
                    Message = &quot;File imported successfully.&quot;,
                    Inserted = result.Inserted,
                    Rejected = result.Rejected,
                    Errors = result.Errors
                });
            }
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[17,9,17,86,1],[18,9,18,10,1],[19,13,19,60,1],[20,9,20,10,1],[24,9,24,10,1],[25,13,25,50,1],[26,13,26,14,1],[27,17,27,56,1],[31,13,31,103,0],[32,13,32,57,0],[33,13,33,56,0],[34,13,34,70,0],[34,70,34,95,0],[34,95,34,104,0],[36,20,36,54,0],[37,13,37,14,0],[38,17,38,108,0],[39,17,45,20,0],[47,9,47,10,1]]);
    </script>
  </body>
</html>